<html>
<head>
    <style>
        body {
            margin: 0;
            background: rgb(187, 168, 168);
            text-align: center;
            color: #ddd;
            font-family: Signika Negative, Asap, sans-serif;
        }

        #trackBarContainer,
        svg {
            display: block;
            position: relative;
            margin: 20px auto;
        }

        #cursor {
            fill: rgb(0, 0, 0);
            stroke-width: 7pt;
            stroke: rgb(255, 0, 0);
            stroke-linejoin: round;
            cursor: grab;
        }

        #units {
            font-size: 2em;
            fill: white;
            user-select: none;
        }

        #bigTicks {
            stroke-width: 3px;
            stroke: white;
        }

        #smallTicks {
            stroke-width: 1px;
            stroke: white;
        }

        #level {
            font-size: 1em;
            font-weight: bold;
            width: 70px;
            border: rgb(187, 168, 168);
            border-radius: 8px;
            text-align: center;
            background: rgb(187, 168, 168);
        }
    </style>
</head>
<body><!--J'ai pris ca dans knob.html dans les notes de cours-->
<svg width="250" viewBox="0 0 200 85" xmlns="http://www.w3.org/2000/svg" version="1.1">
            <defs>
                <!-- DĆ©claration du filtre -->
                <filter id="MyFilter" filterUnits="userSpaceOnUse" x="0" y="0" width="200" height="120">

                    <!-- offsetBlur -->
                    <feGaussianBlur in="SourceAlpha" stdDeviation="4" result="blur"></feGaussianBlur>
                    <feOffset in="blur" dx="4" dy="4" result="offsetBlur"></feOffset>

                    <!-- litPaint -->
                    <feSpecularLighting in="blur" surfaceScale="5" specularConstant=".75" specularExponent="20" lighting-color="#bbbbbb" result="specOut">
                        <fePointLight x="-5000" y="-10000" z="20000"></fePointLight>
                    </feSpecularLighting>
                    <feComposite in="specOut" in2="SourceAlpha" operator="in" result="specOut"></feComposite>
                    <feComposite in="SourceGraphic" in2="specOut" operator="arithmetic" k1="0" k2="1" k3="1" k4="0" result="litPaint"></feComposite>

                    <!-- fusionne offsetBlur + litPaint -->
                    <feMerge>
                        <feMergeNode in="offsetBlur"></feMergeNode>
                        <feMergeNode in="litPaint"></feMergeNode>
                    </feMerge>
                </filter>
            </defs>

            <!-- Ć‰lĆ©ments graphiques -->
            <g filter="url(#MyFilter)">
                <path fill="none" stroke="#D90000" stroke-width="10" d="M50,66 c-50,0 -50,-60 0,-60 h100 c50,0 50,60 0,60z"></path>
                <path fill="#D90000" d="M60,56 c-30,0 -30,-40 0,-40 h80 c30,0 30,40 0,40z"></path>
                <g fill="#FFFFFF" stroke="black" font-size="45" font-family="Verdana">
                    <text x="52" y="52">SVG</text>
                </g>
            </g>
        </svg>
<div id="trackBarContainer" style="width: 600px;">
    <h1>Level <input type="text" id="level" value="0.0"/></h1>
    <svg id="trackbar" viewBox="0 0 1562 255">
        <defs>
            <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:rgb(0, 0, 0);stop-opacity:1"/>
                <stop offset="100%" style="stop-color:rgb(255,0,0);stop-opacity:1"/>
            </linearGradient>
        </defs>
        <path id="bar" fill="url(#grad1)"d="M42.486,104.96C19.021,104.96,0,85.939,0,62.474C0,39.01,19.021,19.988,42.486,19.988h1477.6 c23.465,0,42.486,19.022,42.486,42.486c0,23.465-19.021,42.486-42.486,42.486H42.486z"/>
            <g id="smallTicks">
            <line fill="none" x1="98.555" y1="165.857" x2="98.555" y2="180.03"/>
            <line fill="none" x1="126.901" y1="165.857" x2="126.901" y2="180.03"/>
            <line fill="none" x1="98.555" y1="180.03" x2="98.555" y2="165.857"/>
            <line fill="none" x1="155.248" y1="165.857" x2="155.248" y2="180.03"/>
            <line fill="none" x1="126.901" y1="180.03" x2="126.901" y2="165.857"/>
            <line fill="none" x1="183.595" y1="165.857" x2="183.595" y2="180.03"/>
            <line fill="none" x1="155.248" y1="180.03" x2="155.248" y2="165.857"/>
            <line fill="none" x1="183.595" y1="180.03" x2="183.595" y2="165.857"/>
            <line fill="none" x1="240.287" y1="165.857" x2="240.287" y2="180.03"/>
            <line fill="none" x1="268.634" y1="165.857" x2="268.634" y2="180.03"/>
            <line fill="none" x1="240.287" y1="180.03" x2="240.287" y2="165.857"/>
            <line fill="none" x1="296.98" y1="165.857" x2="296.98" y2="180.03"/>
            <line fill="none" x1="268.634" y1="180.03" x2="268.634" y2="165.857"/>
            <line fill="none" x1="325.327" y1="165.857" x2="325.327" y2="180.03"/>
            <line fill="none" x1="296.98" y1="180.03" x2="296.98" y2="165.857"/>
            <line fill="none" x1="325.327" y1="180.03" x2="325.327" y2="165.857"/>
            <line fill="none" x1="382.02" y1="165.857" x2="382.02" y2="180.03"/>
            <line fill="none" x1="410.366" y1="165.857" x2="410.366" y2="180.03"/>
            <line fill="none" x1="382.02" y1="180.03" x2="382.02" y2="165.857"/>
            <line fill="none" x1="438.713" y1="165.857" x2="438.713" y2="180.03"/>
            <line fill="none" x1="410.366" y1="180.03" x2="410.366" y2="165.857"/>
            <line fill="none" x1="467.06" y1="165.857" x2="467.06" y2="180.03"/>
            <line fill="none" x1="438.713" y1="180.03" x2="438.713" y2="165.857"/>
            <line fill="none" x1="467.06" y1="180.03" x2="467.06" y2="165.857"/>
            <line fill="none" x1="523.752" y1="165.857" x2="523.752" y2="180.03"/>
            <line fill="none" x1="552.099" y1="165.857" x2="552.099" y2="180.03"/>
            <line fill="none" x1="523.752" y1="180.03" x2="523.752" y2="165.857"/>
            <line fill="none" x1="580.445" y1="165.857" x2="580.445" y2="180.03"/>
            <line fill="none" x1="552.099" y1="180.03" x2="552.099" y2="165.857"/>
            <line fill="none" x1="608.792" y1="165.857" x2="608.792" y2="180.03"/>
            <line fill="none" x1="580.445" y1="180.03" x2="580.445" y2="165.857"/>
            <line fill="none" x1="608.792" y1="180.03" x2="608.792" y2="165.857"/>
            <line fill="none" x1="665.484" y1="165.857" x2="665.484" y2="180.03"/>
            <line fill="none" x1="693.831" y1="165.857" x2="693.831" y2="180.03"/>
            <line fill="none" x1="665.484" y1="180.03" x2="665.484" y2="165.857"/>
            <line fill="none" x1="722.178" y1="165.857" x2="722.178" y2="180.03"/>
            <line fill="none" x1="693.831" y1="180.03" x2="693.831" y2="165.857"/>
            <line fill="none" x1="750.524" y1="165.857" x2="750.524" y2="180.03"/>
            <line fill="none" x1="722.178" y1="180.03" x2="722.178" y2="165.857"/>
            <line fill="none" x1="750.524" y1="180.03" x2="750.524" y2="165.857"/>
            <line fill="none" x1="807.216" y1="165.857" x2="807.216" y2="180.03"/>
            <line fill="none" x1="835.563" y1="165.857" x2="835.563" y2="180.03"/>
            <line fill="none" x1="807.216" y1="180.03" x2="807.216" y2="165.857"/>
            <line fill="none" x1="863.91" y1="165.857" x2="863.91" y2="180.03"/>
            <line fill="none" x1="835.563" y1="180.03" x2="835.563" y2="165.857"/>
            <line fill="none" x1="892.256" y1="165.857" x2="892.256" y2="180.03"/>
            <line fill="none" x1="863.91" y1="180.03" x2="863.91" y2="165.857"/>
            <line fill="none" x1="892.256" y1="180.03" x2="892.256" y2="165.857"/>
            <line fill="none" x1="948.949" y1="165.857" x2="948.949" y2="180.03"/>
            <line fill="none" x1="977.295" y1="165.857" x2="977.295" y2="180.03"/>
            <line fill="none" x1="948.949" y1="180.03" x2="948.949" y2="165.857"/>
            <line fill="none" x1="1005.642" y1="165.857" x2="1005.642" y2="180.03"/>
            <line fill="none" x1="977.295" y1="180.03" x2="977.295" y2="165.857"/>
            <line fill="none" x1="1033.989" y1="165.857" x2="1033.989" y2="180.03"/>
            <line fill="none" x1="1005.642" y1="180.03" x2="1005.642" y2="165.857"/>
            <line fill="none" x1="1033.989" y1="180.03" x2="1033.989" y2="165.857"/>
            <line fill="none" x1="1090.681" y1="165.857" x2="1090.681" y2="180.03"/>
            <line fill="none" x1="1119.028" y1="165.857" x2="1119.028" y2="180.03"/>
            <line fill="none" x1="1090.681" y1="180.03" x2="1090.681" y2="165.857"/>
            <line fill="none" x1="1147.375" y1="165.857" x2="1147.375" y2="180.03"/>
            <line fill="none" x1="1119.028" y1="180.03" x2="1119.028" y2="165.857"/>
            <line fill="none" x1="1175.721" y1="165.857" x2="1175.721" y2="180.03"/>
            <line fill="none" x1="1147.375" y1="180.03" x2="1147.375" y2="165.857"/>
            <line fill="none" x1="1175.721" y1="180.03" x2="1175.721" y2="165.857"/>
            <line fill="none" x1="1232.414" y1="165.857" x2="1232.414" y2="180.03"/>
            <line fill="none" x1="1260.76" y1="165.857" x2="1260.76" y2="180.03"/>
            <line fill="none" x1="1232.414" y1="180.03" x2="1232.414" y2="165.857"/>
            <line fill="none" x1="1289.107" y1="165.857" x2="1289.107" y2="180.03"/>
            <line fill="none" x1="1260.76" y1="180.03" x2="1260.76" y2="165.857"/>
            <line fill="none" x1="1317.454" y1="165.857" x2="1317.454" y2="180.03"/>
            <line fill="none" x1="1289.107" y1="180.03" x2="1289.107" y2="165.857"/>
            <line fill="none" x1="1317.454" y1="180.03" x2="1317.454" y2="165.857"/>
            <line fill="none" x1="1374.146" y1="165.857" x2="1374.146" y2="180.03"/>
            <line fill="none" x1="1402.493" y1="165.857" x2="1402.493" y2="180.03"/>
            <line fill="none" x1="1374.146" y1="180.03" x2="1374.146" y2="165.857"/>
            <line fill="none" x1="1430.839" y1="165.857" x2="1430.839" y2="180.03"/>
            <line fill="none" x1="1402.493" y1="180.03" x2="1402.493" y2="165.857"/>
            <line fill="none" x1="1459.186" y1="165.857" x2="1459.186" y2="180.03"/>
            <line fill="none" x1="1430.839" y1="180.03" x2="1430.839" y2="165.857"/>
            <line fill="none" x1="1459.186" y1="180.03" x2="1459.186" y2="165.857"/>
            </g>
            <g id="bigTicks">
            <line fill="none" x1="70.208" y1="194.204" x2="70.208" y2="165.857"/>
            <line fill="none" x1="211.94" y1="194.204" x2="211.94" y2="165.857"/>
            <line fill="none" x1="353.673" y1="194.204" x2="353.673" y2="165.857"/>
            <line fill="none" x1="495.405" y1="194.204" x2="495.405" y2="165.857"/>
            <line fill="none" x1="637.138" y1="194.204" x2="637.138" y2="165.857"/>
            <line fill="none" x1="778.87" y1="194.204" x2="778.87" y2="165.857"/>
            <line fill="none" x1="920.602" y1="194.204" x2="920.602" y2="165.857"/>
            <line fill="none" x1="1062.334" y1="194.204" x2="1062.334" y2="165.857"/>
            <line fill="none" x1="1204.067" y1="194.204" x2="1204.067" y2="165.857"/>
            <line fill="none" x1="1345.799" y1="194.204" x2="1345.799" y2="165.857"/>
            <line fill="none" x1="1487.532" y1="194.204" x2="1487.532" y2="165.857"/>
            </g>
            <polygon id="cursor" fill="none" points="104,129 104,0 36,0 36,129 70,163 104,129 "/>
            <g id="units">
            <text transform="matrix(1 0 0 1 62.7285 230)" font-family="'ArialNarrow'">0</text>
            <text transform="matrix(1 0 0 1 205.4609 230)" font-family="'ArialNarrow'">1</text>
            <text transform="matrix(1 0 0 1 347.1929 230)" font-family="'ArialNarrow'">2</text>
            <text transform="matrix(1 0 0 1 488.9253 230)" font-family="'ArialNarrow'">3</text>
            <text transform="matrix(1 0 0 1 630.6577 230)" font-family="'ArialNarrow'">4</text>
            <text transform="matrix(1 0 0 1 772.3901 230)" font-family="'ArialNarrow'">5</text>
            <text transform="matrix(1 0 0 1 914.1221 230)" font-family="'ArialNarrow'">6</text>
            <text transform="matrix(1 0 0 1 1055.8545 230)" font-family="'ArialNarrow'">7</text>
            <text transform="matrix(1 0 0 1 1197.5869 230)" font-family="'ArialNarrow'">8</text>
            <text transform="matrix(1 0 0 1 1339.3193 230)" font-family="'ArialNarrow'">9</text>
            <text transform="matrix(1 0 0 1 1470.0513 230)" font-family="'ArialNarrow'">10</text>
            </g>
    </svg>
</div>
<script>
    // Constantes
    let cursorOrigin = 36;
    let cursorWidth = 68;
    let cursorOffset = cursorOrigin + cursorWidth / 2;
    let maxPosition = 1417;
    let smallUnit = maxPosition / 50;

    // Largeur du conteneur SVG
    let containerWidth = document.getElementById("trackbar").getBoundingClientRect().width;
    let ecranViewPortRatio = containerWidth / extractViewBoxWidth(document.getElementById("trackbar"));


    function extractViewBoxWidth(svg) {
        return parseInt(svg.getAttribute("viewBox").split(" ")[2]);
    }

    function formatDecimal(number, decimals) {
        return parseFloat(number).toFixed(decimals);
    }

    // éléments DOM
    let cursor = document.getElementById("cursor");
    let level = document.getElementById("level");
    let trackbar = document.getElementById("trackbar");
    let mouseIsDown = false;

    // Ajouter des events listener
    trackbar.addEventListener("pointerdown", function (e) {
        e.target.setPointerCapture(e.pointerId);
        mouseIsDown = true;
    });

    document.addEventListener("pointermove", function (e) {
        if (mouseIsDown) { // si le bouton de la sourie est enfoncé
            let positionX = e.clientX - trackbar.getBoundingClientRect().left;
            let viewportPositionX = Math.round(positionX / ecranViewPortRatio);
            viewportPositionX = Math.round(viewportPositionX / (smallUnit / 2)) * (smallUnit / 2);
            // Limite le curseur pour rester dans les limites du slider
            if (viewportPositionX < cursorOffset) {
                viewportPositionX = cursorOffset;
            } else if (viewportPositionX > maxPosition + cursorOffset) {
                viewportPositionX = maxPosition + cursorOffset;
            }
            // Mise à jour la position curseur sur la barre de suivi en fonction de la souris
            cursor.style.transform = "translate(" + (viewportPositionX - cursorOffset) + 'px, 0px)';
            let levelValue = (viewportPositionX - cursorOffset) / smallUnit * 0.2;
            level.value = formatDecimal(levelValue, 1);
            level.style.color = "rgb(" + Math.round(levelValue / 10 * 255) + ",0 ,0)";
            cursor.style.fill = "rgb(" + Math.round(levelValue / 10 * 255) + ",0 ,0)";
            cursor.style.stroke = "rgb(" + (255 - Math.round(levelValue / 10 * 255)) + ",0 ,0)";
        }
    });

    // si le bouton de la sourie est relacher
    trackbar.addEventListener("pointerup", function (e) {
        e.target.releasePointerCapture(e.pointerId);
        mouseIsDown = false;
    });

    level.addEventListener("change", function (e) {
        if (!mouseIsDown) { // si le bouton de la souris n'est pas enfoncé
            let newValue = parseFloat(level.value); // la valeur qu'on écrit
            if (!isNaN(newValue))// verifie si c'est un nombre valide
            { 
                if (newValue > 10) {
                newValue = 10;
                level.value = newValue.toFixed(1); // limiter à une décimale
            }
               // Limite le niveau à ne pas descendre en dessous de 0
            else if (newValue < 0) {
            newValue = 0;
            level.value = newValue.toFixed(1);
            viewportPositionX = cursorOffset; // Remettre le curseur à sa position d'origine
            }
                let newPositionX = newValue / 0.2 * smallUnit + cursorOffset;
                cursor.style.transform = "translate(" + (newPositionX - cursorOffset) + 'px, 0px)';
                level.style.color = "rgb(" + Math.round(newValue / 10 * 255) + ",0 ,0)";
                cursor.style.fill = "rgb(" + Math.round(newValue / 10 * 255) + ",0 ,0)";
                cursor.style.stroke = "rgb(" + (255 - Math.round(newValue / 10 * 255)) + ",0 ,0)";
            }
        }
    });
</script>
</body>
</html>